---
title: "Project 46"
author: "Avery Holloman"
date: "2024-08-25"
output: html_document
---

```{r}
# Load necessary libraries
library(dplyr)     # For data manipulation
library(ggplot2)   # For plotting
library(caret)     # For creating confusion matrices
library(readxl)    # For reading Excel files

# Load the planetary data
funny_planetary_data <- read_excel("C:/Users/jacob/OneDrive/Desktop/R Studio Projects 2024/Datasets/funny_planetary_data.xlsx")

# View the first few rows and structure of the dataset
head(funny_planetary_data)
str(funny_planetary_data)

# Check correlation matrix to see if any variables stand out
cor_matrix <- cor(funny_planetary_data[, -1])  # Exclude the Planet column which is categorical
print(cor_matrix)

# Fit Logistic Regression using the glm() function
# Assume "Habitability" is the binary response variable
model <- glm(Habitability ~ SolarRadiation + AtmosphericComposition + DistanceFromStar, 
             data = funny_planetary_data, 
             family = binomial)

# Summary of the logistic regression model
summary(model)

# Predict probabilities
predicted_probabilities <- predict(model, type = "response")

# Convert probabilities to binary predictions
predicted_labels <- ifelse(predicted_probabilities > 0.5, 1, 0)

# Confusion matrix to assess accuracy
confusion <- table(Predicted = predicted_labels, Actual = funny_planetary_data$Habitability)
print(confusion)

# Calculate accuracy
accuracy <- mean(predicted_labels == funny_planetary_data$Habitability)
print(paste("Overall Accuracy:", round(accuracy * 100, 2), "%"))

# Plot the predicted probabilities
ggplot(funny_planetary_data, aes(x = SolarRadiation, y = predicted_probabilities, color = as.factor(Habitability))) +
  geom_point(size = 3, alpha = 0.7) +
  scale_color_manual(values = c("dodgerblue", "firebrick")) +
  labs(title = "Predicted Habitability by Solar Radiation",
       x = "Solar Radiation",
       y = "Predicted Probability of Habitability",
       color = "Habitability") +
  theme_minimal() +
  theme(text = element_text(size = 14))

# Split data into training and test sets (70% train, 30% test)
set.seed(123)
train_index <- createDataPartition(funny_planetary_data$Habitability, p = 0.7, list = FALSE)
train_data <- funny_planetary_data[train_index, ]
test_data <- funny_planetary_data[-train_index, ]

# Fit the logistic regression model on training data
train_model <- glm(Habitability ~ SolarRadiation + AtmosphericComposition + DistanceFromStar, 
                   data = train_data, 
                   family = binomial)

# Predict on the test data
test_probabilities <- predict(train_model, newdata = test_data, type = "response")
test_labels <- ifelse(test_probabilities > 0.5, 1, 0)

# Confusion matrix for test data
test_confusion <- table(Predicted = test_labels, Actual = test_data$Habitability)
print(test_confusion)

# Calculate test accuracy
test_accuracy <- mean(test_labels == test_data$Habitability)
print(paste("Test Set Accuracy:", round(test_accuracy * 100, 2), "%"))

# Plot the logistic regression decision boundary
ggplot(train_data, aes(x = SolarRadiation, y = AtmosphericComposition, color = as.factor(Habitability))) +
  geom_point(size = 3, alpha = 0.7) +
  stat_smooth(method = "glm", method.args = list(family = "binomial"), se = FALSE, linetype = "dashed", color = "black") +
  scale_color_manual(values = c("dodgerblue", "firebrick")) +
  labs(title = "Logistic Regression Decision Boundary",
       x = "Solar Radiation",
       y = "Atmospheric Composition",
       color = "Habitability") +
  theme_minimal() +
  theme(text = element_text(size = 14))

# Try a simpler model with just two predictors (SolarRadiation and AtmosphericComposition)
simpler_model <- glm(Habitability ~ SolarRadiation + AtmosphericComposition, 
                     data = train_data, 
                     family = binomial)

# Predict on the test data using the simpler model
simple_test_probabilities <- predict(simpler_model, newdata = test_data, type = "response")
simple_test_labels <- ifelse(simple_test_probabilities > 0.5, 1, 0)

# Confusion matrix for simpler model
simple_test_confusion <- table(Predicted = simple_test_labels, Actual = test_data$Habitability)
print(simple_test_confusion)

# Calculate accuracy for simpler model
simple_test_accuracy <- mean(simple_test_labels == test_data$Habitability)
print(paste("Simpler Model Test Accuracy:", round(simple_test_accuracy * 100, 2), "%"))

# Final visualization comparing actual vs predicted habitability
ggplot(test_data, aes(x = SolarRadiation, y = AtmosphericComposition, color = as.factor(simple_test_labels))) +
  geom_point(size = 3, alpha = 0.7) +
  scale_color_manual(values = c("springgreen3", "orangered2")) +
  labs(title = "Test Data: Actual vs. Predicted Habitability",
       x = "Solar Radiation",
       y = "Atmospheric Composition",
       color = "Predicted Habitability") +
  theme_minimal() +
  theme(text = element_text(size = 14))


```